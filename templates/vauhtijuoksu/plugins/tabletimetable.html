{% load vj_extras static %}

<div class="tabletimetable">
    <div class="tttheader">
        <div class="timestamps">
        </div>
        {% for day in games %}
            <div class="tttday">
                {{ day.1.start_time|date:"w"|fiweekday }} {{ day.1.start_time|date:"j.n." }}
            </div>
        {% endfor %}
    </div>
    <div class="tttcontent">
        <div class="timestamps">
            <div><div>0</div><div>0</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>0</div><div>1</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>0</div><div>2</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>0</div><div>3</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>0</div><div>4</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>0</div><div>5</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>0</div><div>6</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>0</div><div>7</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>0</div><div>8</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>0</div><div>9</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>0</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>1</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>2</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>3</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>4</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>5</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>6</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>7</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>8</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>1</div><div>9</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>2</div><div>0</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>2</div><div>1</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>2</div><div>2</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>2</div><div>3</div><div>:</div><div>0</div><div>0</div></div>
            <div><div>2</div><div>4</div><div>:</div><div>0</div><div>0</div></div>
        </div>

        {% for day in games %}
            <div class="tttday">
                {% for game in day %}
                    <div class="tttgame {{ game.cut_style }}" style="top: {{ game.start_percent }}%; bottom: {{ game.end_percent }}%">
                        <div>
                            <div class="tttimg"><img src="{% static "vauhtijuoksu2023/img/char/"|add:game.img_filename %}"></div>
                            <div>
                                <p>
                                {{ game.game }}
                                    <br>
                                    {{ game.category }}
                                </p>
                                <p>
                                Pelaaja:
                                    {% with game.player|split:"," as players %}
                                        {% with game.player_twitch|split:"," as twitchs %}
                                            {% for p, t in players|zip:twitchs %}
                                                {% if forloop.counter0 > 0 %}
                                                    &
                                                {% endif %}
                                                {% if t %}
                                                    <a class="twitch-link" target="_blank" href="https://www.twitch.tv/{{ t }}">{{ p }} <img class="small-twitch-icon" src="{% static "vauhtijuoksu2023/img/twitch.png" %}"></a>
                                                {% else %}
                                                    {{ p }}
                                                {% endif %}
                                            {% endfor %}
                                        {% endwith %}
                                    {% endwith %}
                                </p>
                                <p>
                                Arvio: {{ game.estimate|duration }}
                                    <br>
                                {{ game.start_time|date:"H:i" }} - {{ game.end_time|date:"H:i" }}
                                </p>
                                {% if game.childsafe or game.flashing %}
                                <div class="meta">
                                    {% if game.childsafe %}
                                      <div title="Pelaaja on merkinnyt runin lapsiystävälliseksi" class="warning w-childsafe"></div>
                                    {% endif %}
                                    {% if game.flashing %}
                                      <div title="Pelaaja on merkinnyt runin sisältävän välkkyviä valoja" class="warning w-flashing"></div>
                                    {% endif %}
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
</div>
